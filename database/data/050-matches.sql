-- Matches (All Sources)
-- Generated by database-driven scraper

INSERT INTO matches (
  home_team_id, away_team_id, match_type_id, match_status_id, match_date,
  home_score, away_score, source_system_id, external_id, scrape_target_id
)
SELECT
  ht.id,
  at.id,
  1, -- match_type_id (Regular Season)
  CASE WHEN m.home_score IS NOT NULL THEN 3 ELSE 1 END, -- match_status_id (3=Completed, 1=Scheduled)
  CURRENT_DATE, -- match_date (APSL pages don't show dates)
  m.home_score,
  m.away_score,
  1, -- source_system_id (APSL)
  m.external_id,
  3 -- scrape_target_id
FROM (VALUES
  ('Hoboken FC 1912', 'Leros SC', 1, 1, '226814'),
  ('Zum Schneider FC 03', 'NY Pancyprian Freedoms', 1, 0, '226815'),
  ('Lansdowne Yonkers FC', 'NY Athletic Club', 4, 1, '226816'),
  ('NY Greek Americans', 'Doxa FCW', 3, 2, '226817'),
  ('Richmond County FC', 'Central Park Rangers FC', 1, 1, '226818'),
  ('NY International FC', 'SC Vistula Garfield', 3, 2, '226819'),
  ('SC Vistula Garfield', 'NY Pancyprian Freedoms', 1, 3, '226820'),
  ('Doxa FCW', 'Lansdowne Yonkers FC', 1, 2, '226821'),
  ('Zum Schneider FC 03', 'NY International FC', 1, 3, '226822'),
  ('Central Park Rangers FC', 'NY Greek Americans', 0, 5, '226823'),
  ('Leros SC', 'NY Athletic Club', 2, 0, '226824'),
  ('Richmond County FC', 'Hoboken FC 1912', 1, 8, '226825'),
  ('NY Pancyprian Freedoms', 'Central Park Rangers FC', 3, 0, '226826'),
  ('Hoboken FC 1912', 'Zum Schneider FC 03', 5, 1, '226827'),
  ('Lansdowne Yonkers FC', 'Leros SC', 0, 0, '226828'),
  ('NY Greek Americans', 'Richmond County FC', 5, 0, '226829'),
  ('NY Athletic Club', 'SC Vistula Garfield', 3, 1, '226830'),
  ('NY International FC', 'Doxa FCW', 3, 2, '226831'),
  ('NY Greek Americans', 'NY Pancyprian Freedoms', 1, 0, '226832'),
  ('Central Park Rangers FC', 'Lansdowne Yonkers FC', 3, 6, '226833'),
  ('NY Athletic Club', 'Hoboken FC 1912', 1, 3, '226834'),
  ('Leros SC', 'NY International FC', 2, 1, '226835'),
  ('SC Vistula Garfield', 'Zum Schneider FC 03', 3, 1, '226836'),
  ('Doxa FCW', 'Richmond County FC', 2, 2, '226837'),
  ('Hoboken FC 1912', 'NY Greek Americans', 4, 5, '226838'),
  ('NY International FC', 'NY Pancyprian Freedoms', 1, 4, '226839'),
  ('SC Vistula Garfield', 'Central Park Rangers FC', 3, 2, '226840'),
  ('Richmond County FC', 'Lansdowne Yonkers FC', 1, 1, '226841'),
  ('Leros SC', 'Zum Schneider FC 03', 0, 1, '226842'),
  ('Doxa FCW', 'NY Athletic Club', 3, 1, '226843'),
  ('Zum Schneider FC 03', 'NY Greek Americans', 0, 5, '226844'),
  ('Central Park Rangers FC', 'Hoboken FC 1912', 1, 5, '226845'),
  ('NY Pancyprian Freedoms', 'Doxa FCW', 4, 1, '226846'),
  ('Richmond County FC', 'NY Athletic Club', 1, 6, '226847'),
  ('Lansdowne Yonkers FC', 'NY International FC', 4, 0, '226848'),
  ('SC Vistula Garfield', 'Leros SC', 2, 4, '226849'),
  ('NY Pancyprian Freedoms', 'Lansdowne Yonkers FC', 0, 3, '226850'),
  ('NY International FC', 'Hoboken FC 1912', 0, 2, '226851'),
  ('NY Athletic Club', 'Central Park Rangers FC', 0, 1, '226852'),
  ('NY Greek Americans', 'Leros SC', 4, 1, '226853'),
  ('Doxa FCW', 'Zum Schneider FC 03', 2, 1, '226854'),
  ('Richmond County FC', 'SC Vistula Garfield', 5, 2, '226855'),
  ('Lansdowne Yonkers FC', 'Hoboken FC 1912', 1, 2, '226856'),
  ('Zum Schneider FC 03', 'Richmond County FC', 2, 4, '226857'),
  ('Leros SC', 'NY Pancyprian Freedoms', 3, 4, '226858'),
  ('Central Park Rangers FC', 'Doxa FCW', 1, 3, '226859'),
  ('NY Athletic Club', 'NY International FC', 1, 2, '226860'),
  ('NY Greek Americans', 'SC Vistula Garfield', 1, 1, '226861'),
  ('Hoboken FC 1912', 'SC Vistula Garfield', 3, 0, '226862'),
  ('Lansdowne Yonkers FC', 'NY Greek Americans', 1, 2, '226863'),
  ('NY Pancyprian Freedoms', 'Richmond County FC', 4, 1, '226864'),
  ('Central Park Rangers FC', 'NY International FC', 2, 2, '226865'),
  ('Doxa FCW', 'Leros SC', 4, 4, '226866'),
  ('NY Athletic Club', 'Zum Schneider FC 03', 2, 3, '226867'),
  ('NY Pancyprian Freedoms', 'NY Athletic Club', 4, 1, '226868'),
  ('Lansdowne Yonkers FC', 'SC Vistula Garfield', 4, 0, '226869'),
  ('Hoboken FC 1912', 'Doxa FCW', 1, 2, '226870'),
  ('Zum Schneider FC 03', 'Central Park Rangers FC', 0, 4, '226871'),
  ('NY International FC', 'NY Greek Americans', 1, 4, '226872'),
  ('Leros SC', 'Richmond County FC', 3, 0, '226873'),
  ('SC Vistula Garfield', 'Doxa FCW', 1, 4, '226876'),
  ('Fitchburg FC', 'Project Football', 1, 2, '227286'),
  ('Praia Kapital', 'Invictus FC', 1, 1, '227287'),
  ('South Coast Union', 'Scrub Nation', 2, 2, '227288'),
  ('Glastonbury Celtic', 'Wildcat FC', 3, 2, '227807'),
  ('Wildcat FC', 'Hermandad Connecticut', 1, 1, '227808'),
  ('WC Predators', 'Jersey Shore Boca', 4, 1, '228134'),
  ('Vidas United FC', 'Sewell Old Boys FC', 4, 0, '228135'),
  ('Lighthouse 1893 SC', 'Philadelphia Soccer Club', 2, 3, '228136'),
  ('Oaklyn United FC', 'Medford Strikers', 4, 1, '228137'),
  ('Real Central NJ Soccer', 'Alloy Soccer Club', 2, 1, '228138'),
  ('Alloy Soccer Club', 'Philadelphia Soccer Club', 5, 3, '228139'),
  ('Sewell Old Boys FC', 'WC Predators', 0, 5, '228140'),
  ('Lighthouse 1893 SC', 'Medford Strikers', 5, 1, '228141'),
  ('Philadelphia Heritage SC', 'Jersey Shore Boca', 3, 0, '228142'),
  ('Alloy Soccer Club', 'Oaklyn United FC', 7, 0, '228143'),
  ('Sewell Old Boys FC', 'Jersey Shore Boca', 0, 0, '228144'),
  ('Lighthouse 1893 SC', 'Real Central NJ Soccer', 1, 2, '228145'),
  ('Philadelphia Heritage SC', 'WC Predators', 0, 1, '228146'),
  ('Philadelphia Soccer Club', 'Vidas United FC', 1, 1, '228147'),
  ('WC Predators', 'Oaklyn United FC', 5, 0, '228148'),
  ('Sewell Old Boys FC', 'Lighthouse 1893 SC', 0, 1, '228149'),
  ('Jersey Shore Boca', 'Alloy Soccer Club', 1, 2, '228150'),
  ('Philadelphia Heritage SC', 'Vidas United FC', 1, 0, '228151'),
  ('Real Central NJ Soccer', 'Philadelphia Soccer Club', 1, 3, '228152'),
  ('WC Predators', 'Real Central NJ Soccer', 2, 1, '228153'),
  ('Vidas United FC', 'Oaklyn United FC', 3, 0, '228154'),
  ('Lighthouse 1893 SC', 'Philadelphia Heritage SC', 0, 0, '228155'),
  ('Philadelphia Soccer Club', 'Medford Strikers', 0, 0, '228156'),
  ('Alloy Soccer Club', 'WC Predators', 3, 5, '228157'),
  ('Vidas United FC', 'Lighthouse 1893 SC', 1, 2, '228158'),
  ('Oaklyn United FC', 'Real Central NJ Soccer', 2, 1, '228159'),
  ('Philadelphia Soccer Club', 'Jersey Shore Boca', 5, 0, '228160'),
  ('Medford Strikers', 'Sewell Old Boys FC', 1, 0, '228161'),
  ('Oaklyn United FC', 'Philadelphia Heritage SC', 1, 2, '228162'),
  ('Jersey Shore Boca', 'Real Central NJ Soccer', 0, 1, '228163'),
  ('Medford Strikers', 'Alloy Soccer Club', 2, 3, '228164'),
  ('Sewell Old Boys FC', 'Philadelphia Heritage SC', 1, 4, '228165'),
  ('Vidas United FC', 'WC Predators', 1, 7, '228166'),
  ('Jersey Shore Boca', 'Lighthouse 1893 SC', 2, 1, '228168'),
  ('Alloy Soccer Club', 'Vidas United FC', 5, 3, '228169'),
  ('Oaklyn United FC', 'Sewell Old Boys FC', 5, 2, '228170'),
  ('Real Central NJ Soccer', 'Medford Strikers', 1, 0, '228171'),
  ('WC Predators', 'Philadelphia Soccer Club', 10, 0, '228172'),
  ('Lighthouse 1893 SC', 'Oaklyn United FC', 1, 2, '228173'),
  ('Philadelphia Heritage SC', 'Alloy Soccer Club', 3, 3, '228174'),
  ('Medford Strikers', 'Vidas United FC', 1, 6, '228175'),
  ('Sewell Old Boys FC', 'Alloy Soccer Club', 0, 2, '228176'),
  ('Medford Strikers', 'Philadelphia Heritage SC', 4, 5, '228177'),
  ('Jersey Shore Boca', 'Vidas United FC', 4, 3, '228178'),
  ('Alloy Soccer Club', 'Lighthouse 1893 SC', 2, 2, '228179'),
  ('Oaklyn United FC', 'Jersey Shore Boca', 2, 0, '228180'),
  ('Medford Strikers', 'WC Predators', 2, 7, '228181'),
  ('Philadelphia Soccer Club', 'Sewell Old Boys FC', 3, 3, '228182'),
  ('Real Central NJ Soccer', 'Philadelphia Heritage SC', 4, 1, '228183'),
  ('WC Predators', 'Lighthouse 1893 SC', 7, 0, '228184'),
  ('Philadelphia Heritage SC', 'Philadelphia Soccer Club', 1, 2, '228185'),
  ('Real Central NJ Soccer', 'Sewell Old Boys FC', 4, 2, '228186'),
  ('Jersey Shore Boca', 'Medford Strikers', 4, 2, '228187'),
  ('Alliance SC', 'Terminus FC', 3, 6, '228201'),
  ('Buckhead SC', 'Peachtree FC', 1, 4, '228202'),
  ('SC Gwinnett', 'Alliance SC', 1, 5, '228204'),
  ('Prima FC', 'Terminus FC', 1, 3, '228205'),
  ('Majestic SC', 'Bel Calcio FC', 1, 1, '228206'),
  ('Alliance SC', 'Prima FC', 2, 6, '228208'),
  ('SC Gwinnett', 'Peachtree FC', 0, 12, '228209'),
  ('Terminus FC', 'Majestic SC', 3, 3, '228210'),
  ('Buckhead SC', 'Bel Calcio FC', 0, 2, '228211'),
  ('Peachtree FC', 'Alliance SC', 9, 2, '228212'),
  ('Prima FC', 'Majestic SC', 5, 3, '228213'),
  ('Terminus FC', 'Buckhead SC', 2, 0, '228215'),
  ('Alliance SC', 'Majestic SC', 2, 4, '228216'),
  ('Buckhead SC', 'Prima FC', 1, 3, '228218'),
  ('Bel Calcio FC', 'SC Gwinnett', 8, 0, '228219'),
  ('Majestic SC', 'Buckhead SC', 3, 1, '228221'),
  ('Peachtree FC', 'Bel Calcio FC', 2, 0, '228222'),
  ('SC Gwinnett', 'Terminus FC', 0, 7, '228223'),
  ('Alliance SC', 'Buckhead SC', 1, 3, '228224'),
  ('Peachtree FC', 'Terminus FC', 3, 7, '228226'),
  ('Prima FC', 'SC Gwinnett', 14, 0, '228227'),
  ('Bel Calcio FC', 'Alliance SC', 2, 4, '228228'),
  ('Majestic SC', 'SC Gwinnett', 18, 0, '228230'),
  ('Peachtree FC', 'Prima FC', 0, 0, '228231'),
  ('Terminus FC', 'Bel Calcio FC', 4, 3, '228232'),
  ('Buckhead SC', 'SC Gwinnett', 13, 0, '228233'),
  ('Majestic SC', 'Peachtree FC', 4, 1, '228235'),
  ('Bel Calcio FC', 'Prima FC', 0, 5, '228236'),
  ('Wave FC', 'PW Nova', 10, 0, '228534'),
  ('Grove Soccer United', 'PW Nova', 3, 0, '228536'),
  ('Wave FC', 'Grove Soccer United', 5, 0, '228597'),
  ('PFA EPSL', 'PW Nova', 5, 2, '229167'),
  ('Nova FC', 'Grove Soccer United', 7, 4, '230061'),
  ('Delmarva Thunder', 'PW Nova', 3, 2, '230062'),
  ('Delmarva Thunder', 'PFA EPSL', 2, 4, '230094'),
  ('PW Nova', 'Grove Soccer United', 1, 0, '230098'),
  ('Falcons FC', 'South Coast Union', 1, 0, '231086'),
  ('Invictus FC', 'Scrub Nation', 0, 3, '231087'),
  ('Project Football', 'Praia Kapital', 1, 4, '231088'),
  ('South Coast Union', 'Praia Kapital', 1, 2, '231089'),
  ('Invictus FC', 'Fitchburg FC', 5, 2, '231090'),
  ('Project Football', 'Falcons FC', 1, 5, '231091'),
  ('Praia Kapital', 'Scrub Nation', 1, 1, '231094'),
  ('Fitchburg FC', 'South Coast Union', 3, 2, '231095'),
  ('Invictus FC', 'Falcons FC', 1, 1, '231096'),
  ('Scrub Nation', 'Falcons FC', 2, 1, '231097'),
  ('South Coast Union', 'Project Football', 7, 2, '231100'),
  ('Praia Kapital', 'Fitchburg FC', 8, 0, '231101'),
  ('Project Football', 'Scrub Nation', 0, 4, '231103'),
  ('Invictus FC', 'South Coast Union', 3, 5, '231104'),
  ('Project Football', 'Invictus FC', 3, 2, '231106'),
  ('Praia Kapital', 'Falcons FC', 2, 0, '231108'),
  ('Scrub Nation', 'Fitchburg FC', 10, 0, '231109'),
  ('Falcons FC', 'Invictus FC', 3, 1, '231110'),
  ('Fitchburg FC', 'Falcons FC', 1, 8, '231111'),
  ('PFA EPSL', 'Christos FC', 2, 5, '231194'),
  ('Falcons FC', 'Fitchburg FC', 1, 0, '233162'),
  ('Delmarva Thunder', 'VA Marauders FC', 3, 1, '233356'),
  ('Nova FC', 'Delmarva Thunder', 8, 0, '233401'),
  ('Wave FC', 'Delmarva Thunder', 4, 1, '233403'),
  ('PFA EPSL', 'Delmarva Thunder', 4, 2, '233404'),
  ('Grove Soccer United', 'Wave FC', 1, 2, '233406'),
  ('Wave FC', 'VA Marauders FC', 1, 2, '234433'),
  ('Nova FC', 'Wave FC', 3, 2, '234437'),
  ('VA Marauders FC', 'PW Nova', 5, 1, '234438'),
  ('PW Nova', 'Christos FC', 0, 1, '234439'),
  ('Grove Soccer United', 'Delmarva Thunder', 4, 1, '234440'),
  ('Nova FC', 'PFA EPSL', 5, 2, '234447'),
  ('VA Marauders FC', 'PFA EPSL', 4, 3, '234448'),
  ('Nova FC', 'Christos FC', 3, 0, '234449'),
  ('VA Marauders FC', 'Christos FC', 1, 0, '234450'),
  ('PW Nova', 'Nova FC', 1, 6, '234452'),
  ('GAK', 'Oaklyn United FC', 0, 2, '236246'),
  ('GAK', 'Medford Strikers', 2, 1, '236250'),
  ('GAK', 'Real Central NJ Soccer', 3, 0, '236251'),
  ('Sewell Old Boys FC', 'GAK', 3, 2, '236270'),
  ('GAK', 'Philadelphia Heritage SC', 3, 2, '236273'),
  ('Vidas United FC', 'GAK', 7, 1, '236276'),
  ('Alloy Soccer Club', 'GAK', 6, 0, '236278'),
  ('GAK', 'WC Predators', 1, 12, '236279'),
  ('GAK', 'Lighthouse 1893 SC', 5, 1, '236280'),
  ('KO Elites', 'Glastonbury Celtic', 4, 2, '236815'),
  ('Hermandad Connecticut', 'Glastonbury Celtic', 5, 6, '236816'),
  ('KO Elites', 'Wildcat FC', 7, 2, '236817'),
  ('Wildcat FC', 'KO Elites', 2, 7, '236818'),
  ('Glastonbury Celtic', 'Hermandad Connecticut', 2, 0, '236819'),
  ('Wildcat FC', 'Glastonbury Celtic', 2, 6, '236820'),
  ('KO Elites', 'Hermandad Connecticut', 5, 2, '236821'),
  ('Glastonbury Celtic', 'KO Elites', 2, 7, '236822'),
  ('Hermandad Connecticut', 'Wildcat FC', 0, 1, '236823'),
  ('Christos FC', 'Grove Soccer United', 0, 4, '237182'),
  ('VA Marauders FC', 'Grove Soccer United', 2, 1, '237183'),
  ('VA Marauders FC', 'Wave FC', 0, 1, '238667'),
  ('VA Marauders FC', 'Delmarva Thunder', 4, 1, '238975'),
  ('Praia Kapital', 'Invictus FC', 4, 3, '242297'),
  ('South Coast Union', 'Scrub Nation', 4, 3, '242310'),
  ('Project Football', 'Strictly Nos FC', 3, 2, '242319'),
  ('South Coast Union', 'Project Football', 3, 1, '245207'),
  ('VA Marauders FC', 'Nova FC', 1, 2, '251157')
) AS m(home_team, away_team, home_score, away_score, external_id)
JOIN teams ht ON ht.name = m.home_team
JOIN teams at ON at.name = m.away_team
ON CONFLICT (source_system_id, external_id) DO UPDATE SET
  home_score = EXCLUDED.home_score,
  away_score = EXCLUDED.away_score,
  match_status_id = EXCLUDED.match_status_id;
